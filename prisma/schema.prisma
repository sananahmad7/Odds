generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ContentType {
  heading
  subheading
  text
  image
}

/**
 * NEW League enum
 */
enum League {
  NFL
  NBA
  NCAAF
  NCAAB
  MLB
  UFC
}

model Article {
  id          Int      @id @default(autoincrement())
  slug        String   @unique
  title       String
  description String
  thumbnail   String
  publishedAt DateTime
  isFeatured  Boolean? @default(false)
  published   Boolean  @default(false)

  /**
   * NEW: league replaces categories
   */
  league League

  /**
   * REMOVED: categories Category[] @relation("ArticleCategories")
   */

  contentBlocks ArticleContent[]
  metaTags      String[]         @default([])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([league])
}

model ArticleContent {
  id          Int         @id @default(autoincrement())
  type        ContentType
  content     String
  description String?
  order       Int
  article     Article     @relation(fields: [articleId], references: [id], onDelete: Cascade)
  articleId   Int
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  @@index([articleId, order])
}

enum AdminRole {
  ADMIN
}

model Admin {
  id           Int       @id @default(autoincrement())
  email        String    @unique
  passwordHash String
  name         String?
  role         AdminRole @default(ADMIN)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model ContactMessage {
  id        Int      @id @default(autoincrement())
  name      String
  email     String
  message   String   @db.Text
  createdAt DateTime @default(now())
  read      Boolean  @default(false)

  @@index([createdAt])
}
